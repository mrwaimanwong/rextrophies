
var VPC_CONFIG=(function(b,a){b(document).ready(function(){if(typeof vpc!="undefined"){accounting.settings={currency:{symbol:vpc.currency,format:vpc.price_format,decimal:vpc.decimal_separator,thousand:vpc.thousand_separator,precision:vpc.decimals},number:{precision:vpc.decimals,thousand:vpc.thousand_separator,decimal:vpc.decimal_separator}}}window.vpc_build_preview=function(){if(typeof vpc=="undefined"){return}b("#vpc-preview").html("");if(b("#vpc-add-to-cart").data("price")){if(vpc.decimal_separator==","){var h=parseFloat(b("#vpc-add-to-cart").data("price").toString().replace(",","."))}else{var h=parseFloat(b("#vpc-add-to-cart").data("price"))}}var i=[];if(!h){h=0}var j=wp.hooks.applyFilters("vpc.items_selected",vpc.vpc_selected_items_selector);var g=wp.hooks.applyFilters("vpc.default_preview_builder_process",true);if(g){b(j).each(function(){var l=b(this).data("img");var k=b(this).data("price");if(k){h+=parseFloat(k)}if(l){b("#vpc-preview").append("<img src='"+l+"'>");i.push(l)}});h=wp.hooks.applyFilters("vpc.total_price",h);b("#vpc-price").html(accounting.formatMoney(h))}else{wp.hooks.doAction("vpc.default_preview_builder_process",j)}};window.vpc_apply_rules=function(g){if(typeof vpc=="undefined"){return}if(typeof g=="undefined"){g=vpc.vpc_selected_items_selector}var h=false;b(g).each(function(l,m){var k=b(this).attr("id");var j=vpc.wvpc_conditional_rules[k];if(typeof j=="undefined"){return true}b.each(j,function(i,n){b.each(n,function(o,p){var q=true;b.each(p.rules,function(r,s){if(typeof p.conditions_relationship=="undefined"){p.conditions_relationship="and"}var t=b(".vpc-options input[data-oid='"+s.option+"']").attr("checked")=="checked";if(!t){t=b(".vpc-options input[data-oid='"+s.option+"']").is(":checked")}t=wp.hooks.applyFilters("vpc.is_option_selected",t,s.option);if(p.conditions_relationship=="or"&&((s.trigger=="on_selection"&&t)||(s.trigger=="on_deselection"&&!t))){q=true;return false}else{if(p.conditions_relationship=="or"){q=false}else{if(p.conditions_relationship=="and"&&((s.trigger=="on_selection"&&!t)||(s.trigger=="on_deselection"&&t))){q=false;return false}}}});if(q){if(p.result.action=="hide"){h=true;d(p)}else{if(p.result.action=="show"){h=true;f(p)}else{if(p.result.action=="select"){h=true;c(p)}}}}else{if(p.apply_reverse=="on"){if(p.result.action=="hide"){h=true;f(p)}else{if(p.result.action=="show"&&b("#"+p.result.apply_on).not("[style*='display: none;']").length){h=true;d(p)}else{if(p.result.action=="select"){h=true;e(p)}}}}}})})});if(h){vpc_build_preview()}};if(typeof vpc!="undefined"){b(vpc.reverse_triggers).each(function(g,h){vpc_apply_rules("#"+h)})}window.vpc_load_options=function(){if(typeof vpc!=="undefined"){console.log(vpc.vpc_selected_items_selector);b(vpc.vpc_selected_items_selector).each(function(){b(this).trigger("change")})}};b(document).on("click","#vpc-qty-container .plus, #vpc-qty-container .minus",function(){var h=b("#vpc-qty");var i=parseFloat(h.val());var g=parseFloat(h.attr("max"));var j=parseFloat(h.attr("min"));var k=h.attr("step");if(!i||i===""||i==="NaN"){i=0}if(g===""||g==="NaN"){g=""}if(j===""||j==="NaN"){j=0}if(k==="any"||k===""||k===undefined||parseFloat(k)==="NaN"){k=1}if(b(this).is(".plus")){if(g&&(g==i||i>g)){h.val(g)}else{h.val(i+parseFloat(k))}}else{if(j&&(j==i||i<j)){h.val(j)}else{if(i>0){h.val(i-parseFloat(k))}}}});b(document).on("click","#vpc-add-to-cart",function(){var h=b(this).data("pid");var i=[];b("#vpc-container input:checked").each(function(m){if(b(this).data("product")){i.push(b(this).data("product"))}});var k=b("#vpc-qty").val();var g=b("#vpc-container").find(":input").serializeJSON();var l={};l=wp.hooks.applyFilters("vpc.custom_vars",l);var j=wp.hooks.applyFilters("vpc_proceed_add_to_cart",true);if(j){b.post(ajax_object.ajax_url,{action:"add_vpc_configuration_to_cart",product_id:h,alt_products:i,quantity:k,recap:g,custom_vars:l},function(m){b("#debug").html(m);switch(vpc.action_after_add_to_cart){case"refresh":setTimeout(function(){window.location.reload(true)},3000);break;case"redirect":window.location.href=vpc.cart_url;break;case"redirect_to_product_page":window.location.href=vpc.current_product_page;break;default:break}wp.hooks.doAction("vpc.after_add_to_cart",m)})}else{wp.hooks.doAction("vpc_proceed_add_to_cart",l)}});b(".single_variation_wrap").on("show_variation",function(i,g){var h=b("input[name='variation_id']").val();if(h){b(".vpc-configure-button").hide();b(".vpc-configure-button[data-id='"+h+"']").show()}});function d(g){if(g.result.scope=="component"&&(b("#vpc-container div.vpc-component[data-component_id="+g.result.apply_on+"]").not("[style*='display: none;']").length)){b("#vpc-container div.vpc-component[data-component_id="+g.result.apply_on+"]").hide();b("#vpc-container div.vpc-component[data-component_id="+g.result.apply_on+"]").find("input:checked").removeAttr("checked").trigger("change")}else{if(g.result.scope=="option"&&b(".vpc-options div[data-oid='"+g.result.apply_on+"']").not("[style*='display: none;']").length){b(".vpc-options div[data-oid='"+g.result.apply_on+"']").hide();b(".vpc-options div[data-oid='"+g.result.apply_on+"'] input:checked").removeAttr("checked").trigger("change");b(".vpc-options div[data-oid='"+g.result.apply_on+"']").parents(".vpc-options").find(".vpc-single-option-wrap").not("[style*='display: none;']").find("input").first().prop("checked",true).trigger("change")}}wp.hooks.doAction("vpc.hide_options_or_component",g)}function f(g){if(g.result.scope=="component"&&b("#vpc-container div.vpc-component[data-component_id='"+g.result.apply_on+"'][style*='display: none;']").length){b("#vpc-container div.vpc-component[data-component_id="+g.result.apply_on+"]").show();if(b("#vpc-container div.vpc-component[data-component_id="+g.result.apply_on+"]").find(".vpc-options input[data-default]").length){b("#vpc-container div.vpc-component[data-component_id="+g.result.apply_on+"]").find(".vpc-options input[data-default]").click()}else{b("#vpc-container div.vpc-component[data-component_id="+g.result.apply_on+"]").find(".vpc-options input").first().click()}}else{if(g.result.scope=="option"&&b(".vpc-options div[data-oid='"+g.result.apply_on+"'][style*='display: none;']").length){b(".vpc-options div[data-oid='"+g.result.apply_on+"']").show();if(!b(".vpc-options div[data-oid='"+g.result.apply_on+"']").parents(".vpc-options").find(".vpc-single-option-wrap").not("[style*='display: none;']").find("input:checked").length){b(".vpc-options div[data-oid='"+g.result.apply_on+"']").parents(".vpc-options").find(".vpc-single-option-wrap").not("[style*='display: none;']").find("input").first().prop("checked",true).trigger("change")}}}wp.hooks.doAction("vpc.show_options_or_component",g)}function c(g){if(g.result.scope=="option"&&b(".vpc-options div[data-oid='"+g.result.apply_on+"']").length){b(".vpc-options div[data-oid='"+g.result.apply_on+"']").show();b(".vpc-options div[data-oid='"+g.result.apply_on+"']>input").prop("checked",true).trigger("change")}wp.hooks.doAction("vpc.select_options_or_component",g)}function e(g){if(g.result.scope=="option"&&b(".vpc-options div[data-oid='"+g.result.apply_on+"']").not("[style*='display: none;']").length){b(".vpc-options div[data-oid='"+g.result.apply_on+"']>input").prop("checked",false).trigger("change")}wp.hooks.doAction("vpc.hide_options_or_component",g)}if(b("#vpc-ajax-container").length){b.post(ajax_object.ajax_url,{action:"get_vpc_editor",vpc:vpc,},function(g){b("#vpc-ajax-container").removeClass("vpc-loading").html(g);vpc_load_options();wp.hooks.doAction("vpc.ajax_loading_complete")})}b(document).on("click",".cart .vpc-configure-button",function(h){h.preventDefault();var g=b("[name='variation_id']").val();if(!g){g=b('[name="add-to-cart"]').val()}var i=b(this).parent().find("input[name='quantity']").val();b.post(ajax_object.ajax_url,{action:"get_vpc_product_qty",prod_id:g,qty:i},function(j){window.location=j})})});return a}(jQuery,VPC_CONFIG));